<mvc:View controllerName="code.d07.exercise30.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:t="sap.ui.table"    
    xmlns:f="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
>
    <Page id="page" title="{i18n>title}">

        <!-- /Orders?$filter=OrderDate ge datetime'1996-12-01T00:00:00' 
                        and OrderDate le datetime'1996-12-13T23:59:59' -->
        <t:Table
            rows="{
                path: '/Orders',
                filters: [{ 
                    path: 'OrderDate',
                    operator: 'BT',
                    value1: '1996-12-01',
                    value2: '1996-12-31' }
                ],
                parameters: {
                    expand: 'Customer, Employee'
                }
            }"
            selectionBehavior="RowOnly"
            selectionMode="Single"
            rowSelectionChange=".onRowSelectionChange"
        >
        
            <t:columns>
                <!-- 첫 번째 칼럼 주문번호 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnOrderID}"/>
                    </t:label>
                    <t:template>
                        <ObjectIdentifier title="{OrderID}"/>
                    </t:template>
                </t:Column>
                <!-- 두 번째 칼럼 고객ID -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnCustomerID}"/>
                    </t:label>
                    <t:template>
                        <Text text="{CustomerID}"/>
                    </t:template>
                </t:Column>
                <!-- 세 번째 칼럼 고객명 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnContactName}"/>
                    </t:label>
                    <t:template>
                        <Text text="{Customer/ContactName}"/>
                    </t:template>
                </t:Column>
                <!-- 네 번째 칼럼 연락처 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnPhone}"/>
                    </t:label>
                    <t:template>
                        <Text text="{Customer/Phone}"/>
                    </t:template>
                </t:Column>
                <!-- 다섯 번째 칼럼 거주지 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnCity}"/>
                    </t:label>
                    <t:template>
                        <Text text="{Employee/City}"/>
                    </t:template>
                </t:Column>
                <!-- 여섯 번째 칼럼 주문일자 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnOrderDate}"/>
                    </t:label>
                    <t:template>
                        <Text 
                            text="{
                                path: 'OrderDate',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: {
                                    pattern: 'yyyy-MM-dd'
                                }
                            }"/>
                    </t:template>
                </t:Column>
            
            </t:columns>

        </t:Table>

        <Panel headerText="주문정보">
            <!-- columnsM="2"
                -> 화면 크기 M 에 칼럼 2개 세팅 허용 -->
            <f:SimpleForm 
                layout="ResponsiveGridLayout" 
                editable="true"
                columnsL="2"
                columnsM="2"
            >
                <f:content>
                    <core:Title text="기본정보"/>
                    <Label text="선택한 주문ID"/>
                    <Text text="{OrderID}"/>
                    <Label text="직원ID"/>
                    <Text text="{EmployeeID}"/>
                    <Label text="직원명"/>
                    <Text text="{Employee/FirstName} {Employee/LastName}"/>

                    <core:Title text="고객정보"/>
                    <Label text="고객ID"/>
                    <Text text="{CustomerID}"/>
                    <Label text="고객명"/>
                    <Text text="{Customer/ContactName}"/>
                
                </f:content>

            </f:SimpleForm>
        </Panel>
        
        <Panel headerText="주문세부내역">
            <t:Table
                rows="{
                    path: 'Order_Details',
                    parameters:{
                        expand: 'Product'
                    },
                    sorter: {
                        path: 'UnitPrice'
                    }
                }"
                selectionBehavior="RowOnly"
            >

                <!-- 첫 번째 컬럼 주문ID -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnOrderID}"/>
                    </t:label>
                    <t:template>
                        <Text text="{OrderID}"/>
                    </t:template>
                </t:Column>
                <!-- 두 번째 컬럼 제품ID -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnProductID}"/>
                    </t:label>
                    <t:template>
                        <Text text="{ProductID}"/>
                    </t:template>
                </t:Column>

                <!-- 세 번째 컬럼 제품명 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnProductName}"/>
                    </t:label>
                    <t:template>
                        <Text text="{Product/ProductName}"/>
                    </t:template>
                </t:Column>

                <!-- 네 번째 컬럼 개당 가격 -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnUnitPrice}"/>
                    </t:label>
                    <t:template>
                        <ObjectNumber 
                            number="{
                                parts: [
                                    { path: 'UnitPrice' },
                                    { path: 'view>/Currency' }
                                ],
                                type: 'sap.ui.model.type.Currency',
                                formatOptions: {
                                    showMeasure: false
                                }
                            }"
                            unit="{view>/Currency}"
                        />
                    </t:template>
                </t:Column>

                <!-- 다섯 번째 컬럼 수량 EA -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnProductQuntity}"/>
                    </t:label>
                    <t:template>
                        <ObjectNumber 
                            number="{
                                parts:[
                                    'Quantity',
                                    'view>/unit'
                                ],
                                type: 'sap.ui.model.type.Unit',
                                formatOptions: {
                                    showMeasure: false
                                }
                            }"
                            unit="{view>/Unit}"
                        />
                    </t:template>
                </t:Column>

                <!-- 여섯 번째 컬럼 할인 % -->
                <t:Column>
                    <t:label>
                        <Label text="{i18n>columnDiscount}"/>
                    </t:label>
                    <t:template>
                        <!-- number="{= ${Discount}*${i18n>makePercent} }" -->
                        <ObjectNumber 
                            number="{ 
                                path: 'Discount',
                                formatter: '.formatter.discountText'
                            }"
                            unit="%"
                        />
                    </t:template>
                </t:Column>
            </t:Table>
        </Panel>


    </Page>
</mvc:View>